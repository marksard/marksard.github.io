---
layout: post
title: PCBから自作キーボードを作りたい(別注編)
date: 2018-10-20 22:00:00 +0900
tag: [hardware, keyboard, gogofunk]
image: 20181010-PA100019.jpg
---

# じつはもうひとつ…

　#ash2entyを発注したあとfusionPCBで10cm四方のPCBが3枚1ドルっていうキャンペーンをやっているのに気がついてお得やんなんか作ろう！って考えてたらキーボード基板を発注していました。  

## 19mm四方x5で10cmに収まる

　キースイッチひとつに必要なスペースは19.05mm四方なので5x5で10cmに収まるやんというところから作り始めました。  

* 5x5 25キー
* TRRS接続なし
* OLEDなし
* バックライトOLEDなし
* ホットスワップなし
* 全部1U
* テンキーパッド、ショートカットパッドなどでの利用を想定

　当時のキャンペーン締め切りが迫ってたのとキースイッチの領域でいっぱいいっぱいなのと、pro microをキー裏に取り付けるのもあってバックライトやホットスワップは諦めて#ash2entyとは対極のシンプルな仕様にしました。  

## 回路・基板

　キースイッチとダイオードのフットプリントはリバーシブル仕様なんですがpro microは片面のみです。  
　締め切りへの間に合わせでシルクの配置やフットプリントの選定など雑さがぬぐえません…が、配線はキレイに整えたつもり。  

## プレート

　時間の都合上基板へロゴを入れれなかったので、ボトムプレートに彫刻してもらいました。  
　Inkscapeに付属してたフォントと[シルエットデザイン](http://kage-design.com/wp/)さんのフリー素材を使いました。  
　発注は游舎工房さんへ。  

## ソフト

　#ash2entyはHelixのソースコードを元にしていたのですが今回はLEDもOLEDもTRRS通信もないので、QMK_Firmwareの新キーボード用のテンプレートバッチを使って新規作成しました。（[ないんさん](https://twitter.com/pluis9)ありがとうございます）  

　とりあえずreadme.mdとかはガン無視でキーマップ作ってピンアサインと行列数を変更して対応しました。  

## 組み立て

　基板、プレート、ネジ類、pro microも到着したので組み立てます。  
　ダイオードを付け、リセットスイッチを付け、プレートを間に挟んでキースイッチを付けていきます。  
　急いでたのか色々ハード面で不具合が出ました…

### 不具合その1

　早速の不具合。pro microは交換出来るよう、またロープロファイルになるようスプリングピンヘッダを想定してたのですが、キースイッチの真ん中軸受けがpro microのMCUに当たって浮きます。  
　1キーだけなのでスイッチ側を削って対応しました。  

![img](/assets/photos/20181010-PA100004.jpg)  

### 不具合その2

　今回ダイオードをスイッチの上部に横配置するようにしたんですがこれもpro microに干渉する…のでスイッチ面に取り付け。2キーだけスイッチ面に取り付けて対応しました。  

![img](/assets/photos/20181010-PA100003.jpg)  

### 不具合その3

　pro microのmicro usbコネクタがダイオードのランドに当たってショートする。  
　絶縁テープを貼って対応しました。  

![img](/assets/photos/20181010-PA100002.jpg)  


### 不具合その4

　Numlock LEDくらいは点灯させたいなーとぼんやり考えていたのをすっかり忘れてたので、急遽Pro microにLEDと抵抗1kΩを直付けしました。  

![img](/assets/photos/20181010-PA100009.jpg)  

## 完成

　不具合は色々あったものの完成しました！  

![img](/assets/photos/20181010-PA100011.jpg)  
![img](/assets/photos/20181010-PA100015.jpg)  

　アクリルの濃い青とPCBの白がポイントです。裏面にはロゴとNumlockのLED。  
　ソフト的にも1レイヤーしかまだ入れてないし、右端のF1-F5も今のところ割り当ててないのでシンプルです（入れたところで割り当て可能なキャップがないですが…）。

　5x5が案外大きく見えてしまうのはSAキーキャップを付けているのと、トッププレートとボトムプレートを繋ぐスペーサーを余裕をもって11mmにしてて高さが出ているせいかもしれません。スペーサーは10mmにしたほうが良かった…。  

　スイッチは前にHelixから外したシリコングリス塗布済みのCherry赤軸を再利用。スムースにシュコシュコ入って気持ちいいです。
  
![img](/assets/photos/20181010-PA100005.jpg)  

## まとめ

![img](/assets/photos/20181010-PA100019.jpg)  

　急造ゆえのトラブルが出ましたがそれでも機能的には満足行くものが出来ました。早速#ash2entyと一緒に使ってみましたが、左手で操作するテンキー、意外に良いですね。トラックボールから手を放さずに数字を入れられます。  
　キーボード側にトグルで切り替わる左手テンキーモードとかいれておく手もありますけど、物理的にテンキーがあるとダイレクトに操作できて良い感じです。  
