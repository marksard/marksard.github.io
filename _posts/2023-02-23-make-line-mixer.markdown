---
layout: post
title: ラインミキサーを自作してみた
date: 2023-02-23 09:00:00 +0900
tag: [hardware, audio]
image: 20230222-P2220005.jpg
---

## 小さいのが欲しい

最近楽器を触ってて。  

- パリピデストロイヤーというアシッドベースマシン
- teenage engineering PO-32というリズムマシン
- Behringer TD-3というRoland TB-303クローンのベースマシン

を同期演奏させつつ音声もミックスしたい。  
それとPO-32とパリピデストロイヤーのSync出力が、TD-3のSync inが機能する2.5Vの以上のシンク信号じゃないため増幅しないといけない（ちなみにTD-3は2PPQNには対応しているのでPO-32もパリピも2PPQNのシンク信号を出せる）  

市販のアナログミキサー1台買ってもいいんだけど、パリピとPO-32が小さいのでそれに合わせて小さめなのが欲しい。小さいのも売ってるけど標準フォンだったり仕様がイマイチわからないから思ったように使えるの？的なところもあり…  
で「試しに自分で作ってみるかー」となりました。  
欲しい機能はこんな。  

- 入出力は全部3.5mmミニプラグ
- メイン出力とヘッドホンモニター出力の2out
- オーディオは3ch入力程度
- Sync出力増幅用のための独立した入出力
- コンパクトなもの

kicadの回路シミュレーションやって確認したりブレボで動作テストしたりしている間に考えた最終案のブロックダイアグラム  
![img](/assets/photos/mlm0802.png)

- A/B2系統各3ch
- AにLch、BにRchのステレオ1ch入力
- A/B2系統各メイン出力
- A/B2系統セレクタ付きのステレオモニター出力

という機能が付いてて、主に

- 2系統の独立した3chモノラルミキサー
- 4chステレオミキサー
- AのoutをBのchに挿せばモノラル5chミキサー

といった具合に使いまわせるような構成にしました。  
上に書いた機能の「Sync出力増幅用のための独立した入出力」は2系統目に入れれば解決。  

電源は楽器関連で採用が多い2.1mmDC9Vセンターマイナスの電源アダプタ仕様にして電源の共通化を図る。  
電源回りは超簡素。コモンモードフィルタとか回路保護も省略。  
入力機器側である程度レベル上げておいて各chのレベルコントロールは下げる方向で使う前提で各chゲインアップなし。  
オペアンプは単電源4.5Vバイアス動作。  
メイン出力はMAXで+10dBくらいに調整しました。  
モニター出力はいわゆるメイン出力のポストフェーダー出力にしました。  
部品は日本橋で現地調達出来るように選定。出力の分配で入力インピーダンスを上げるために使ったFETは2SK170と2SK303を使えるようにフットプリントを組んだ（2SK170は手持があったため）。オペアンプは9Vで動くならなんでもイケるかなというところ。  

配線は太めに設定して、あらかじめルートをひきやすいように配置に配慮したうえでオートルータ―にお任せ。  
配線完了後ベタGNDにビアを手打ち。  

100x100mmに収まりました。JLCPCBのブラックPCBはハーフマットですごく好みなので毎回頼んでしまう。  
![img](/assets/photos/IMG_5194.jpg)

キャパシタは全部寝かして高さを抑え適当な容量を稼いで、抵抗は逆に立てて省スペースに。  
リード線地獄にしたくなかったのでスイッチ、可変抵抗、ジャックを直立タイプの基板付けにして高さが合う部品を探しました。  
パーツが林立するのがたまらんですね。  
![img](/assets/photos/IMG_5201.jpg)

パリピとPO-32と並べて撮ってみました。自作キーボードだと5x5キーのマクロパッドなサイズに収まっているので結構コンパクトです。  
本体厚みも最薄部が18mm。パーツの重みとネジ留めで剛性感もありしっかりした作りになりました。  
![img](/assets/photos/20230222-P2220005.jpg)

## 作って良かった点

- さっと広げてさっとしまえる

エフェクタ用の分配アダプタ1つで共用出来て取り回しも楽。さっと広げてつなげて遊んで、さっと仕舞えるのは結構便利。  
今はチャムスのマルチハードケースにガッと一式押し込んでます。空間に余裕がありますが、これは楽器を増やゲフンゲフン…  
![img](/assets/photos/20230222-P2220017.jpg)

- 各楽器のレベル微調整がしやすい

パリピもPO-32もレベル調整が10数段階程度なので微妙な調整が出来るようになったのはメリット。  

手軽にイヤホンだけ繋いだり、イヤホンとパラでデスク据え置きのモニタースピーカーが繋がっているUSBミキサーにラインでつなげられるのも良い。  

- スイッチング電源でもノイズが気にならない

入力未接続で全ノブをMAXにすると流石にサーっとホワイトノイズが乗るけど、なんの対策もしてないわりに普段使うレンジでは-100dB以下で問題なく使えます。むしろ無再生時のパリピのノイズがよく聞える。  

## 反省点

### 作りながらなんとなくそうなるだろうなと薄々思ってたもの  

- ノブ同士の間隔が近い → ノブ系を11mm程度のものに変えた
- ノブとジャックの間隔も近い → しゃーなし
- 自作フットプリントのスルーホールのパッド幅がちょっと狭かった → はんだ付けそのものは出来たのでヨシ
- A/B2系統セレクタを切り替えた時のポップノイズ

 → 想像は付いてたけどやっぱり…セレクタICとかにすれば良くなるかもしれない。まぁ頻繁に変更しないだろうしヨシ。  

- 出力のほうの可変抵抗の脚が見えててそこに指を1cmくらい近づけちゃうとブーンとノイズが乗る

 → 出力の可変抵抗の脚が触れる位置にある設計が悪いので反省。まー指を近づけなければヨシ。  

- モニターアウトのボリュームの雑音

モニターアウトのボリュームノブを回すとローパスフィルタ掛けたホワイトノイズみたいな音がカスカスと入ってしまう。バチバチ、ガリガリとまでは言わないのでこのままでいいかと思っているけど、倍率は固定にしてFETのソースバッファ直後に可変抵抗入れたほうが良かったかも。  

- パーツ代が結構嵩んだ

可変抵抗をALPSのRK09Lシリーズで1個220円以上でそれが10個で2000円は超えてた。ノブもなんか高いやつ買ったりして最初10個+3個で3000円くらい。ジャックも150円くらいして10個で1500円。電源スイッチとセレクタスイッチは高さを抑えるために色々みてたら自照式のを見つけてしまってカッコいいから揃えた挙句3つで1500円くらいしたしオーディオグレードのキャパシタも積算すると良いお値段してた（）ので全部で9000円くらい。ブレボでテストする用に治具買ったりもしたので実際もっと散財しててミキサー素直に買った方が全然安いじゃんってなりました。  
ALPS互換の可変抵抗と、ノブをaliexpressとかで買うと半額くらいにはなりそう。あとはRK09Dシリーズのものに変えるか。
スイッチは別の安い部品でもいいかもしれない。  

### バグ

- 電源コネクタのフットプリントミス

電源コネクタのフットプリント、実物を入手してから急いで変更したせいでロクに実物のピン位置確認せずにフットプリント書いてしまったせいで間違ってました。幸い未使用ピン（プラグの挿抜でスイッチするタイプのピン）だったのでカットするだけで装着出来て良かった…  

- GND側を電源スイッチで入切する仕様に変えたせいで電源分配アダプタを使うと他の同じ電源の聴きを繋ぐと電源スイッチそのものはOFFなのにグランドが繋がってるため電源が入っている状態になる  

もう一つのも急ぎでやったせいで…電源スイッチはLED内臓タイプでしかも緑と赤が入ってるタイプなのでせっかくなら電源ON → 緑、OFF → 赤みたいに色変えよう！と思って。データシートを見るとアノードコモン(+側が共通)なので、エイっとGND側の接続をスイッチで入り切りする仕様に変えちゃったんですよね。これがよくなかった。  

このミキサーに使っている電源が分配タイプの電源アダプタ（9Vセンターマイナス）で、TD-3（9Vセンターマイナス）とミキサーにこの電源アダプタを使って、TD-3とミキサーを繋ぐと、ミキサーのスイッチそのものは電源OFF状態なのに、TD-3のグランドを通じてミキサーと繋がってて電源が入った状態になってて音が鳴る、という不具合。  
共通アダプタを使わなければ発生しないのですが、まぁちょっと凹みましたね…  

### おまけ

パリピデストロイヤーのsync信号をみたらパルスの頂点は3.3Vくらいあるけど立ち上がり直前が1.7Vとかになってってこれが同期しない原因ぽい。
ブレボ上のミキサーの試作回路を通せば同期するのは確認はしたんだけど、どうせならちゃんとしたパルスにしてあげようと思ってコンパレータICで5V/0Vに整えるシンク信号用アンプを作ることにしました。
![img](/assets/photos/paripi_138bpm_2ppq.jpg)

ちなみにこれはPO-32のシンク波形。キレイだけど0.8Vくらい。音量設定でちょっと変わるっぽい。  
![img](/assets/photos/po-32_120bpm_2ppq.jpg)

9V電源を5Vレギュレータで降圧して動作電圧としています。vrefはいわゆるスレッショルド設定になります。  
コンパレータICの2回路の片方はLEDにして、スレッショルド設定を変更したときのシンク出力の状態をチェック出来るようにしています。  
![img](/assets/photos/comparator.jpg)

基板発注するのもアレだしとユニバーサル基板に手配線してプラケースに入れました。  
海外の方でディストーションエフェクタを使って増幅してるのをみたので全然それでも良かったなぁと今更思い出したり。  
![img](/assets/photos/IMG_5166.jpg)

昭和テイストな雰囲気。  
![img](/assets/photos/20230222-P2220019.jpg)

## 自作ミキサーと自作シンクアンプでセッティングした状態

60x30cmくらいの場所に広げてうにょうにょ遊べます。物理的に繋いで物理的なノブをオペレートするのはとても楽しい。  
![img](/assets/photos/20230222-P2220016.jpg)
